{
  "test_summary": {
    "task": "Verify Cognito groups appear in JWT tokens",
    "total_tests": 17,
    "passed_tests": 14,
    "failed_tests": 3,
    "success_rate": "82.4%",
    "jwt_groups_verified": false,
    "frontend_integration_ready": false,
    "test_users": [
      "test.regular@hdcn-test.nl",
      "test.member.admin@hdcn-test.nl",
      "test.chairman@hdcn-test.nl",
      "test.webmaster@hdcn-test.nl"
    ],
    "next_steps": [
      "Integrate getUserRoles() function in frontend",
      "Integrate calculatePermissions() function in frontend",
      "Update UI components to use role-based permissions",
      "Test with real browser-based passwordless authentication"
    ]
  },
  "test_results": [
    {
      "timestamp": "2025-12-25T20:18:09.558410",
      "test": "User test.regular@hdcn-test.nl (Regular Member)",
      "success": true,
      "details": "Status: FORCE_CHANGE_PASSWORD, Enabled: True\n   Actual groups: ['hdcnLeden']\n   Expected groups: ['hdcnLeden']\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:09.694944",
      "test": "User test.member.admin@hdcn-test.nl",
      "success": false,
      "details": "User not found. Run create_test_users.py first.",
      "error": "An error occurred (UserNotFoundException) when calling the AdminGetUser operation: User does not exist."
    },
    {
      "timestamp": "2025-12-25T20:18:10.222478",
      "test": "User test.chairman@hdcn-test.nl (National Chairman)",
      "success": true,
      "details": "Status: FORCE_CHANGE_PASSWORD, Enabled: True\n   Actual groups: ['Communication_Read_All', 'System_Logs_Read', 'Members_Status_Approve', 'Events_Read_All', 'Members_Read_All', 'Products_Read_All']\n   Expected groups: ['Members_Read_All', 'Members_Status_Approve', 'Events_Read_All', 'Products_Read_All', 'Communication_Read_All', 'System_Logs_Read']\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:10.583431",
      "test": "User test.webmaster@hdcn-test.nl (Webmaster)",
      "success": true,
      "details": "Status: FORCE_CHANGE_PASSWORD, Enabled: True\n   Actual groups: ['Events_CRUD_All', 'Members_Read_All', 'System_User_Management', 'Products_CRUD_All', 'Communication_Export_All']\n   Expected groups: ['Members_Read_All', 'Events_CRUD_All', 'Products_CRUD_All', 'Communication_Export_All', 'System_User_Management']\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:11.108748",
      "test": "JWT structure for test.regular@hdcn-test.nl (Regular Member)",
      "success": true,
      "details": "Has all required claims: True\n   Has cognito:groups claim: True\n   Groups in token: ['hdcnLeden']\n   Groups match actual: True\n   Username correct: True\n   Email correct: True\n   Token use correct: True\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:11.313311",
      "test": "JWT structure for test.member.admin@hdcn-test.nl (Member Administration)",
      "success": true,
      "details": "Has all required claims: True\n   Has cognito:groups claim: True\n   Groups in token: []\n   Groups match actual: True\n   Username correct: True\n   Email correct: True\n   Token use correct: True\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:11.628665",
      "test": "JWT structure for test.chairman@hdcn-test.nl (National Chairman)",
      "success": true,
      "details": "Has all required claims: True\n   Has cognito:groups claim: True\n   Groups in token: ['Communication_Read_All', 'System_Logs_Read', 'Members_Status_Approve', 'Events_Read_All', 'Members_Read_All', 'Products_Read_All']\n   Groups match actual: True\n   Username correct: True\n   Email correct: True\n   Token use correct: True\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:11.913388",
      "test": "JWT structure for test.webmaster@hdcn-test.nl (Webmaster)",
      "success": true,
      "details": "Has all required claims: True\n   Has cognito:groups claim: True\n   Groups in token: ['Events_CRUD_All', 'Members_Read_All', 'System_User_Management', 'Products_CRUD_All', 'Communication_Export_All']\n   Groups match actual: True\n   Username correct: True\n   Email correct: True\n   Token use correct: True\n",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:12.213693",
      "test": "Role extraction for test.regular@hdcn-test.nl (Regular Member)",
      "success": true,
      "details": "Extracted roles: ['hdcnLeden']\n   Expected roles: ['hdcnLeden']\n   Roles match: True\n   Calculated permissions (4): ['edit_own_motorcycle_data', 'edit_own_personal_data', 'view_own_profile', 'webshop_access']",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:12.350107",
      "test": "Role extraction for test.member.admin@hdcn-test.nl (Member Administration)",
      "success": false,
      "details": "Extracted roles: []\n   Expected roles: []\n   Roles match: True\n   Calculated permissions (0): []",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:12.525492",
      "test": "Role extraction for test.chairman@hdcn-test.nl (National Chairman)",
      "success": true,
      "details": "Extracted roles: ['Communication_Read_All', 'System_Logs_Read', 'Members_Status_Approve', 'Events_Read_All', 'Members_Read_All', 'Products_Read_All']\n   Expected roles: ['Communication_Read_All', 'System_Logs_Read', 'Members_Status_Approve', 'Events_Read_All', 'Members_Read_All', 'Products_Read_All']\n   Roles match: True\n   Calculated permissions (13): ['communication_list', 'communication_read', 'events_list', 'events_read', 'members_list']...",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:12.751862",
      "test": "Role extraction for test.webmaster@hdcn-test.nl (Webmaster)",
      "success": true,
      "details": "Extracted roles: ['Events_CRUD_All', 'Members_Read_All', 'System_User_Management', 'Products_CRUD_All', 'Communication_Export_All']\n   Expected roles: ['Events_CRUD_All', 'Members_Read_All', 'System_User_Management', 'Products_CRUD_All', 'Communication_Export_All']\n   Roles match: True\n   Calculated permissions (21): ['communication_bulk_export', 'communication_export', 'communication_mailing_lists', 'events_create', 'events_delete']...",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:13.041902",
      "test": "Groups claim validation for test.regular@hdcn-test.nl (Regular Member)",
      "success": true,
      "details": "Is list: True\n   Not empty (or basic user): True\n   All strings: True\n   No empty strings: True\n   Matches expected: True\n   Valid role names: True\n   Groups: ['hdcnLeden']",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:13.146439",
      "test": "Groups claim validation for test.member.admin@hdcn-test.nl (Member Administration)",
      "success": false,
      "details": "Is list: True\n   Not empty (or basic user): False\n   All strings: True\n   No empty strings: True\n   Matches expected: False\n   Valid role names: True\n   Groups: []",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:13.346053",
      "test": "Groups claim validation for test.chairman@hdcn-test.nl (National Chairman)",
      "success": true,
      "details": "Is list: True\n   Not empty (or basic user): True\n   All strings: True\n   No empty strings: True\n   Matches expected: True\n   Valid role names: True\n   Groups: ['Communication_Read_All', 'System_Logs_Read', 'Members_Status_Approve', 'Events_Read_All', 'Members_Read_All', 'Products_Read_All']",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:13.549887",
      "test": "Groups claim validation for test.webmaster@hdcn-test.nl (Webmaster)",
      "success": true,
      "details": "Is list: True\n   Not empty (or basic user): True\n   All strings: True\n   No empty strings: True\n   Matches expected: True\n   Valid role names: True\n   Groups: ['Events_CRUD_All', 'Members_Read_All', 'System_User_Management', 'Products_CRUD_All', 'Communication_Export_All']",
      "error": null
    },
    {
      "timestamp": "2025-12-25T20:18:13.553131",
      "test": "JWT groups integration readiness",
      "success": true,
      "details": "All components ready for frontend integration with cognito:groups claim",
      "error": null
    }
  ]
}